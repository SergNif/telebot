# telebot
telebot MFTI
# Итоговая работа
## Телеграмм-бот  @serggnfbot
### Нифантьев Сергей User ID: 50698472 
######  [мой телеграмм чат](https://t.me/SergNifant)
тел +7-9182565930 есть Telegramm WhatsUP Viber  

###  Общее описание
Задание состоит из двух частей:
* Обработка изображения
* Создание телеграмм-бота
Так для обработки изображения нужны значительные вычислительные мощности, то одновременная работа двух приложений, разделяющмх эти ресурсы будет затруднительной и некомфортной для пользователя.
Для решения этой проблемы я нашёл три способа:
    * [Разместить](#17) проект на сервере с GPU <a id="12"></a>
    * [Разработать](#16) асинхронный код<a id="13"></a>, который бы позволил разделить эти две задачи на независымые потоки.
    * [Разделить](#15) <a id="14"></a> две задачи между двумя независимыми сереверами


<a id="17"></a>Способ с [GPU](#12) для меня показался очень дорогим. Цена эксплуатации довольно приемлемая, но так как у меня никакого опыта разработки, то мне понадобилось бы много времени на освоение разворачивания этого проекта. А время там очень дорогое.

<a id="16"></a>На изучение полностью [асинхронного кода](#13) у меня ушло очень много времени, но я так и не смог сделать что-то существенное. Так как сроки сдачи проекта уже "поджимали", то пришлось отказаться и от этого способа.

<a id="15"></a>Совместная работа синхронного приложения, бота и модели обработки изображения, я посчитал совсем неприемлемым. Поэтому выбрал вариант с [размещением проекта на двух серверах](#14).
### Основная часть

## -- Этапы работы --
#### 1. Реализация модели
Код реализованной модели находится в [репозитории](https://github.com/SergNif/server) на GitHub. Часть работы модели реализована в классах. Сам процесс переноса стиля изображения реализован в функции. Применяется предобученная модель VGG16. Обработка изображения запускается с сервера с телеграмм-ботом командой через SSH. Для этого используется библиотека [paramiko](https://www.paramiko.org/). После обработки изображение отправляется обратно на сервер с ботом
#### 1. Реализация телеграмм-бота
* Бот реализован на библиотеке [pyTelegramBotAPI 4.4.0](https://pypi.org/project/pyTelegramBotAPI/). В описании библиотеки написано, что в ней реализована асинхронность. Но так как я до конца не разобрался в, то не могу оценить насколько хорошо всё работает. Но бот принимает команды непрерывно и ответы приходят "не по очереди". Из чего я могу сделать вывод, что асинхронность в боте реализована. Сообщения с сервера с моделью об итерациях обработки тоже приходят в Телеграм независимо ни от чего.
* ##### Функциональность бота
    В интерфейсе бота есть 4 командные кнопки 
######    1. /style стиль<a id="18"></a>
Работа с изображениеьм:
Предлагается использовать один из 9 вариантов стиля или отказаться от них.
Если стиль был выбран, то предлагается прислать каринку для обработки. После загрузки изображения выводится сообщение "Ожидайте.." 
В процессе обработки в чат приходят сообщения о количестве сделанных итераций
######    2. /button данные
Пользователю пердлагается посмотреть вои данные, можно отказаться.
Если Yes, то запрашивается какие данные пользователь хотел бы посмотерть: свой ID ил UserNIC
выводится информация по запросу
######    3. /help описание
Кратко выводится информация о возможностях бота
######    4. /start старт
Приветствие и небольшое описание
######    5. Текст
При вводе любого текста приходит ответ с рандомным числом от 1 до 100
######    4. Смайлик
Если отправить боту НЕ команду, текст, изображение, то в ответ в чат придёт шуточный эмодзи.

#### Обработка изображения
Чтобы бот обработал изображение ему нужно отправить 2 изображения.
Затем бот предложит выбрать с которого из них нужно перенести стиль.
После обработки обработанное изображение придёт в чат.

Или можно отправить изображение по кнопке-команде [/style](#18) с выбором из предложенного стиля.

Изображения идентифицируются по chat.id в имени файлов.
Так как изображений может быть отправлено несколько пар от разных пользователей, то в коде бота реализована очередь отправки файлов на сервер с моделью.

#### Асинхронность
Между любыми операциями можно выполнять любые другие операции



В процессе создания проекта столкнулся с огромным количеством новой интересной увлекательной информации. К сожалению, было потрачено много времени на интересные эксперименты с новым кодом.
Поэтому многое из задания сделать не успел и не смог.
Спасибо за очень интересное задание. 
